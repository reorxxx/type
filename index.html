<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Pro</title>
    <style>
:root {
    --bg-color: #2c3e50;
    --text-color: #ecf0f1;
    --primary-color: #e74c3c;
    --correct-color: #2ecc71;
    --key-bg: rgba(255, 255, 255, 0.1);
    --key-hover-bg: rgba(255, 255, 255, 0.2);
}

body {
    background-color: var(--bg-color);
    color: var(--text-color);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
}

.container {
    width: 90%;
    max-width: 800px;
    text-align: center;
}

.stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: 40px;
    font-size: 1.5rem;
}

.stat-value {
    font-size: 2.5rem;
    font-weight: bold;
}

#text-display {
    font-size: 1.8rem;
    margin-bottom: 40px;
    line-height: 1.6;
    letter-spacing: 1px;
}

#text-display span {
    padding: 2px 1px;
    border-radius: 3px;
}

#text-display .current {
    background-color: var(--primary-color);
    color: var(--bg-color);
}

#text-display .correct {
    color: var(--correct-color);
}

#text-display .incorrect {
    color: var(--primary-color);
    text-decoration: underline;
}

#input-area {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    border: 0;
}

#keyboard {
    margin: 40px 0;
    width: 100%;
}

.keyboard-row {
    display: flex;
    margin-bottom: 8px;
}

.keyboard-row:nth-child(2) { }
.keyboard-row:nth-child(3) { }
.keyboard-row:nth-child(4) { }


.key {
    background-color: var(--key-bg);
    border-radius: 5px;
    text-align: center;
    text-transform: capitalize;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 15px 0;
    margin: 0 4px;
    flex-grow: 1;
    flex-basis: 0;
    font-size: 1rem;
}

.key.active {
    background-color: var(--primary-color);
    transform: scale(1.1);
}

#restart-btn {
    background-color: var(--primary-color);
    color: var(--text-color);
    border: none;
    padding: 15px 30px;
    font-size: 1.2rem;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
}

#restart-btn:hover {
    background-color: #c0392b;
}
    </style>
</head>
<body>
    <div class="container">
        <div class="stats">
            <div class="stat-item">
                <div class="stat-value" id="wpm">0</div>
                <div class="stat-label">WPM</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="accuracy">100%</div>
                <div class="stat-label">Accuracy</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="time">0s</div>
                <div class="stat-label">Time</div>
            </div>
        </div>
        <div id="text-display"></div>
        <input type="text" id="input-area" autofocus>
        <div id="keyboard"></div>
        <button id="restart-btn">Restart</button>
    </div>
    <script>
document.addEventListener('DOMContentLoaded', () => {
    const textDisplay = document.getElementById('text-display');
    const inputArea = document.getElementById('input-area');
    const wpmElement = document.getElementById('wpm');
    const accuracyElement = document.getElementById('accuracy');
    const timeElement = document.getElementById('time');
    const restartBtn = document.getElementById('restart-btn');
    const keyboard = document.getElementById('keyboard');

    const textSamples = [
        "The quick brown fox jumps over the lazy dog.",
        "Pack my box with five dozen liquor jugs.",
        "How vexingly quick daft zebras jump.",
        "Bright vixens jump; dozy fowl quack.",
        "Sphinx of black quartz, judge my vow.",
        "The five boxing wizards jump quickly."
    ];
    
    let characters = [];
    let currentIndex = 0;
    let startTime;
    let timer;
    let correctChars = 0;
    let totalChars = 0;

    function startNewTest() {
        clearInterval(timer);
        textDisplay.innerHTML = '';
        inputArea.value = '';

        const text = textSamples[Math.floor(Math.random() * textSamples.length)];
        characters = text.split('').map(char => {
            const span = document.createElement('span');
            span.innerText = char;
            textDisplay.appendChild(span);
            return span;
        });

        if (characters.length > 0) {
            characters[0].classList.add('current');
        }

        currentIndex = 0;
        startTime = null;
        correctChars = 0;
        totalChars = 0;
        wpmElement.innerText = '0';
        accuracyElement.innerText = '100%';
        timeElement.innerText = '0.00s';
        inputArea.focus();
    }

    function handleInput() {
        if (currentIndex >= characters.length) {
            return; // Test is finished
        }

        if (!startTime) {
            startTime = new Date();
            timer = setInterval(updateTime, 10);
        }

        const typedText = inputArea.value;
        const typedChar = typedText.slice(-1);
        const currentCharSpan = characters[currentIndex];

        totalChars++;

        if (typedChar === currentCharSpan.innerText) {
            currentCharSpan.classList.remove('current');
            currentCharSpan.classList.add('correct');
            correctChars++;
        } else {
            currentCharSpan.classList.remove('current');
            currentCharSpan.classList.add('incorrect');
        }

        currentIndex++;

        if (currentIndex < characters.length) {
            characters[currentIndex].classList.add('current');
        } else {
            endTest();
        }
        
        updateStats();
    }

    function updateStats() {
        const elapsedTime = (new Date() - startTime) / 1000;
        if (elapsedTime > 0) {
            const wpm = Math.round(((correctChars / 5) / elapsedTime) * 60);
            wpmElement.innerText = wpm;
        }
        const accuracy = totalChars > 0 ? Math.round((correctChars / totalChars) * 100) : 100;
        accuracyElement.innerText = `${accuracy}%`;
    }

    function updateTime() {
        const elapsedTime = (new Date() - startTime) / 1000;
        timeElement.innerText = `${elapsedTime.toFixed(2)}s`;
    }

    function endTest() {
        clearInterval(timer);
        inputArea.blur();
    }

    function createKeyboard() {
        const keysLayout = [
            // Row 1
            [{ code: 'Backquote', text: '`' }, { code: 'Digit1', text: '1' }, { code: 'Digit2', text: '2' }, { code: 'Digit3', text: '3' }, { code: 'Digit4', text: '4' }, { code: 'Digit5', text: '5' }, { code: 'Digit6', text: '6' }, { code: 'Digit7', text: '7' }, { code: 'Digit8', text: '8' }, { code: 'Digit9', text: '9' }, { code: 'Digit0', text: '0' }, { code: 'Minus', text: '-' }, { code: 'Equal', text: '=' }, { code: 'Backspace', text: 'Backspace', flexGrow: 2 }],
            // Row 2
            [{ code: 'Tab', text: 'Tab', flexGrow: 1.5 }, { code: 'KeyQ', text: 'Q' }, { code: 'KeyW', text: 'W' }, { code: 'KeyE', text: 'E' }, { code: 'KeyR', text: 'R' }, { code: 'KeyT', text: 'T' }, { code: 'KeyY', text: 'Y' }, { code: 'KeyU', text: 'U' }, { code: 'KeyI', text: 'I' }, { code: 'KeyO', text: 'O' }, { code: 'KeyP', text: 'P' }, { code: 'BracketLeft', text: '[' }, { code: 'BracketRight', text: ']' }, { code: 'Backslash', text: '\\', flexGrow: 1.5 }],
            // Row 3
            [{ code: 'CapsLock', text: 'CapsLock', flexGrow: 1.75 }, { code: 'KeyA', text: 'A' }, { code: 'KeyS', text: 'S' }, { code: 'KeyD', text: 'D' }, { code: 'KeyF', text: 'F' }, { code: 'KeyG', text: 'G' }, { code: 'KeyH', text: 'H' }, { code: 'KeyJ', text: 'J' }, { code: 'KeyK', text: 'K' }, { code: 'KeyL', text: 'L' }, { code: 'Semicolon', text: ';' }, { code: 'Quote', text: "'" }, { code: 'Enter', text: 'Enter', flexGrow: 2.25 }],
            // Row 4
            [{ code: 'ShiftLeft', text: 'Shift', flexGrow: 2.25 }, { code: 'KeyZ', text: 'Z' }, { code: 'KeyX', text: 'X' }, { code: 'KeyC', text: 'C' }, { code: 'KeyV', text: 'V' }, { code: 'KeyB', text: 'B' }, { code: 'KeyN', text: 'N' }, { code: 'KeyM', text: 'M' }, { code: 'Comma', text: ',' }, { code: 'Period', text: '.' }, { code: 'Slash', text: '/' }, { code: 'ShiftRight', text: 'Shift', flexGrow: 2.75 }],
            // Row 5
            [{ code: 'ControlLeft', text: 'Ctrl', flexGrow: 1.25 }, { code: 'AltLeft', text: 'Alt', flexGrow: 1.25 }, { code: 'Space', text: ' ', flexGrow: 6.25 }, { code: 'AltRight', text: 'Alt', flexGrow: 1.25 }, { code: 'ControlRight', text: 'Ctrl', flexGrow: 1.25 }]
        ];

        keysLayout.forEach(row => {
            const rowElement = document.createElement('div');
            rowElement.classList.add('keyboard-row');
            row.forEach(keyInfo => {
                const keyElement = document.createElement('div');
                keyElement.classList.add('key');
                keyElement.innerText = keyInfo.text;
                keyElement.setAttribute('data-code', keyInfo.code);
                // Use a default flex-grow of 1 for standard keys
                keyElement.style.flexGrow = keyInfo.flexGrow || 1;
                rowElement.appendChild(keyElement);
            });
            keyboard.appendChild(rowElement);
        });
    }
    
    inputArea.addEventListener('input', handleInput);
    restartBtn.addEventListener('click', startNewTest);

    document.addEventListener('keydown', (e) => {
        inputArea.focus();
        const keyElement = document.querySelector(`.key[data-code='${e.code}']`);
        if (keyElement) {
            keyElement.classList.add('active');
        }
    });

    document.addEventListener('keyup', (e) => {
        const keyElement = document.querySelector(`.key[data-code='${e.code}']`);
        if (keyElement) {
            keyElement.classList.remove('active');
        }
    });

    createKeyboard();
    startNewTest();
});
    </script>
</body>
</html>